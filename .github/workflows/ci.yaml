---
name: ğŸ§ª Test

on:
  push:

jobs:
  lint:
    name: ğŸ§¹ Lint
    runs-on: ubuntu-latest
    if: github.actor != 'renovate[bot]'
    steps:
      - name: ğŸ“¥ Checkout repository
        uses: actions/checkout@v6

      - name: ğŸ§¹ Lint
        uses: pre-commit/action@v3.0.1

  test:
    name: ğŸ§ª Test
    runs-on: ubuntu-latest
    if: github.actor != 'renovate[bot]'
    needs:
      - lint

    steps:
      - name: ğŸ“¥ Checkout repository
        uses: actions/checkout@v6
        with:
          fetch-depth: 0

      - name: â˜¸ Setup Helm
        uses: azure/setup-helm@v3

      - name: ğŸ”Œ Install plugin and repo
        run: |
          helm plugin install https://github.com/helm-unittest/helm-unittest --version v1.0.2
          helm repo add bjw-s https://bjw-s-labs.github.io/helm-charts --force-update
          helm dependency build src/

      - name: ğŸ§ª Run tests
        run: |
          helm unittest ./src
